# 날짜 : 2022-10-19 07:29

# 주제 : #java #JVM 
----
# 메모

```toc
```

```ad-note
title: tl;dr
- 
```


## 클래스 로더
![](../img/Pasted%20image%2020221020065239.png)
로딩 -> 링크 -> 초기화 순으로 진행된다.

### 로딩
- 클래스 로더가 .class 파일을 읽고 그 내용에 따라 적절한 바이너리 데이터를 만들고 `메소드 영역`에 저장
- 이 때 메소드 영역에 저장하는 데이터
	- FQCN (Fully Qualified Class Name) : 패키지 경로
	- 클래스 / 인터페이스 / 이늄 같은 타입정보 
	- 메소드와 변수
- 로딩이 끝나면 해당 클래스 타입의 Class 객체를 생성하여 `힙` 영역에 저장
	- App이라는 클래스가 있다면, 로딩이 끝나고  `Class<App>` 이런 식으로 Class 객체가 힙 영역에 생성됨


### 링크
- Verify, Prepare, Resolve(optional) 세 단계로 나누어져 있다.
- Verify 검증 : .class 파일 형식이 유효한지 체크
- Prepare : 메모리를 준비하는 과정. 클래스 변수 (static 변수)와 기본값에 필요한 메모리를 준비한다
- Resolve : 심볼릭 메모리 레퍼런스를 메소드 영역에 있는 실제 레퍼런스로 교체한다. 
	- 옵셔널이기 때문에 이 때 할 수도 있고, 나중에 실제 해당 레퍼런스를 사용할 때 발생할 수도 있다. 


### 초기화
- static 변수의 값을 할당한다. (static 블럭이 있다면 이때 실행된다)



## 세 가지 클래스 로더
부트 스트랩 클래스 로더가 가장 상위의 부모. 플랫폼 클래스 로더, 애플리케이션 클래스 로더 순으로 내려간다.
```ad-attention
title: 클래스 로더의 동작 원리
어떤 클래스를 읽어달라는 요청이 들어오면 클래스를 읽어올 때 
1. 제일 부모인 `부트 스트랩 클래스 로더`에 먼저 요청을 한다
2. 부트스트랩 클래스 로더가 못읽으면 그 다음인 `플랫폼 클래스 로더`가 읽는다
3. 모든 부모가 못읽으면 본인인 `애플리케이션 클래스 로더`가 읽는다
4. 본인도 못읽으면 `ClassNotFoundException`이 발생한다
```

### 부트 스트랩 클래스 로더
- `JAVA_HOME\lib` 에 있는 코어 자바 API를 제공한다. 최상위 우선순위를 가진 클래스 로더

### 플랫폼 클래스 로더
- `JAVA_HOME\lib\ext` 폴더 또는 `java.ext.dirs` 시스템 변수에 해당하는 위치에 있는 클래스를 읽는다.

### 애플리케이션 클래스 로더 
- `애플리케이션 클래스 패쓰`에서 클래스를 읽는다.
	- 애플리케이션 클래스 패쓰 :애플리케이션 실행할 때 주는 -classpath 옵션 또는 java.class.path 환경 변수의 값에 해당하는 위치

# 출처(참고문헌)
- 

# 연결문서
- [JVM 이해하기](JVM%20이해하기.md)
